angular.module("angularPromiseButtons",[]),angular.module("angularPromiseButtons").directive("promiseBtn",["angularPromiseButtons","$parse","$timeout","$compile",function(a,b,c,d){"use strict";return{restrict:"EA",priority:a.config.priority,scope:{promiseBtn:"=",promiseBtnOptions:"=?",ngDisabled:"=?"},link:function(e,f,g){function h(a,b){s.btnLoadingClass&&!s.addClassToCurrentBtnOnly&&a.addClass(s.btnLoadingClass),s.disableBtn&&!s.disableCurrentBtnOnly&&a.attr("disabled","disabled"),b&&s.showProgress&&b.removeClass("ng-hide")}function i(a,b){s.minDuration&&!q||!r||(s.btnLoadingClass&&a.removeClass(s.btnLoadingClass),s.disableBtn&&!e.ngDisabled&&a.removeAttr("disabled"),b&&s.showProgress&&b.addClass("ng-hide"))}function j(a,b,d){e.$watch(a,function(a){q=!1,r=!1,s.minDuration&&(p=c(function(){q=!0,i(b,d)},s.minDuration)),a&&a.then?(h(b,d),a.finally?a.finally(function(){r=!0,i(b,d)}):a.then(function(){r=!0,i(b,d)}).catch(function(){r=!0,i(b,d)})):a&&a.$promise&&(h(b),a.$promise.finally(function(){r=!0,i(b,d)}))})}function k(a){return a.split(";").map(function(a){return b(a)})}function l(a){a.append(d(s.spinnerTpl)(e))}function m(a){s.addClassToCurrentBtnOnly&&a.on(s.CLICK_EVENT,function(){a.addClass(s.btnLoadingClass)}),s.disableCurrentBtnOnly&&a.on(s.CLICK_EVENT,function(){a.attr("disabled","disabled")})}function n(a,b,c,d){e.$evalAsync(function(){var h=k(g[b]);f.unbind(a),f.bind(a,function(a){e.$apply(function(){h.forEach(function(b){var f=b(e.$parent,{$event:a});o||(o=j(function(){return f},c,d))})})})})}var o,p,q,r,s=a.config;if(g.promiseBtn)l(f),m(f),j(function(){return e.promiseBtn},f);else{var t=function(){return angular.element(document).find(s.PROGRESS_SELECTOR)}();if(g.hasOwnProperty(s.CLICK_ATTR))l(f),m(f),n(s.CLICK_EVENT,s.CLICK_ATTR,f,t);else if(g.hasOwnProperty(s.SUBMIT_ATTR)){var u=function(b){for(var c=[],d=b.find(a.config.BTN_SELECTOR),e=0;e<d.length;e++){var f=d[e];"submit"===angular.element(f).attr("type")&&c.push(f)}return angular.element(c)}(f);l(u),m(u),n(s.SUBMIT_EVENT,s.SUBMIT_ATTR,u,t)}}e.$watch("promiseBtnOptions",function(a){angular.isObject(a)&&(s=angular.extend({},s,a))},!0),e.$on("$destroy",function(){c.cancel(p)})}}}]),angular.module("angularPromiseButtons").provider("angularPromiseButtons",function(){"use strict";var a={spinnerTpl:'<span class="btn-spinner"></span>',priority:0,disableBtn:!0,btnLoadingClass:"is-loading",addClassToCurrentBtnOnly:!1,disableCurrentBtnOnly:!1,minDuration:!1,showProgress:!1,CLICK_EVENT:"click",CLICK_ATTR:"ngClick",SUBMIT_EVENT:"submit",SUBMIT_ATTR:"ngSubmit",BTN_SELECTOR:"button",PROGRESS_SELECTOR:"md-progress-linear"};return{extendConfig:function(b){a=angular.extend(a,b)},$get:function(){return{config:a}}}});